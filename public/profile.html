<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/x-icon" href="assets/FocusFlow.ico" />
    <link rel="stylesheet" href="css/theme.css" />
    <title>Profile - FocusFlow</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

    <link rel="stylesheet" href="css/profile.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <div class="header-container">
          <h1 class="site-logo">FocusFlow Profile</h1>
          <div class="nav-links">
            <a href="/" class="nav-link">‚Üê Back to Tracker</a>
            <a href="/blogs" class="nav-link">üìù Blogs</a>
            <a href="/profile" class="nav-link active">üë§ Profile</a>
          </div>
        </div>
      </header>

      <div class="main-container">
        <!-- Left Column (70%) -->
        <div class="left-column">
          <!-- Profile Header -->
          <!-- Enhanced Profile Header -->
          <div class="profile-header">
            <div class="avatar-container">
              <div class="pixel-avatar" id="userAvatar">üë§</div>
              <div class="user-level-badge" id="userLevelBadge">Noob</div>
            </div>
            <div class="profile-info">
              <div class="profile-name-container">
                <h1 class="profile-name" id="userName">Loading...</h1>
                <div class="profile-badge" id="profileOwnerBadge">
                  My Profile
                </div>

                <!-- Add this right after the profile-name-container div -->
                <div class="profile-actions">
                  <button class="share-profile-btn" onclick="shareProfile()">
                    <span>üîó</span>
                    <span>Share Profile</span>
                  </button>
                </div>
              </div>
              <p class="profile-bio" id="userBio">
                Member since <span id="joinDate">...</span>
              </p>

              <!-- ADD THIS SECTION FOR STATUS DISPLAY -->
              <div class="profile-status" id="profileStatus">
                <div class="status-indicator" id="statusIndicator"></div>
                <span class="status-text" id="statusText"
                  >Loading status...</span
                >
              </div>

              <div class="profile-follow-section" style="margin-top: 15px">
                <div class="follow-stats" style="display: flex; gap: 15px">
                  <div
                    class="follow-stat"
                    onclick="showFollowingModal()"
                    style="cursor: pointer"
                  >
                    <span class="follow-count" id="followingCount">0</span>
                    <span class="follow-label">Following</span>
                  </div>
                  <div
                    class="follow-stat"
                    onclick="showFollowersModal()"
                    style="cursor: pointer"
                  >
                    <span class="follow-count" id="followersCount">0</span>
                    <span class="follow-label">Followers</span>
                  </div>
                </div>
              </div>

              <!-- Enhanced Stats Grid -->
              <div class="profile-stats">
                <div class="stat-item">
                  <div class="stat-value" id="totalSolved">0</div>
                  <div class="stat-label">Problems Solved</div>
                  <div class="stat-trend" id="solvedTrend">+0 today</div>
                </div>
                <div class="stat-item">
                  <div class="stat-value" id="totalBlogs">0</div>
                  <div class="stat-label">Blogs Written</div>
                  <div class="stat-trend" id="blogsTrend">+0 this week</div>
                </div>
                <div class="stat-item">
                  <div class="stat-value" id="currentStreak">0</div>
                  <div class="stat-label">Day Streak</div>
                  <div class="stat-trend" id="streakStatus">Keep going! üî•</div>
                </div>
                <div class="stat-item">
                  <div class="stat-value" id="activeDays">0</div>
                  <div class="stat-label">Active Days</div>
                  <div class="stat-trend" id="activityTrend">Consistency</div>
                </div>
              </div>

              <!-- Additional Profile Details -->
              <div class="profile-details-grid">
                <div class="detail-item">
                  <span class="detail-label">Current Level</span>
                  <span class="detail-value" id="userLevel">Noob</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Total XP</span>
                  <span class="detail-value" id="totalXP">0</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Avg. Daily</span>
                  <span class="detail-value" id="avgDaily">0</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Max Streak</span>
                  <span class="detail-value" id="maxStreak">0</span>
                </div>
              </div>

              <!-- Enhanced Social Links Section -->
              <div
                class="social-links-section"
                id="socialLinksSection"
                style="margin-top: 20px"
              >
                <div class="social-links-header">
                  <h2 class="social-links-title">üîó Social Links</h2>
                  <button
                    class="social-links-edit-btn"
                    onclick="toggleSocialLinksEdit()"
                    id="editSocialLinksBtn"
                  >
                    <span>‚úèÔ∏è</span>
                    <span>Edit Links</span>
                  </button>
                </div>

                <!-- Display View -->
                <div class="social-links-display" id="socialLinksDisplay">
                  <!-- Social links will be dynamically inserted here -->
                </div>

                <!-- Edit View -->
                <div class="social-links-grid" id="socialLinksGrid">
                  <!-- Social link inputs will be dynamically inserted here -->
                </div>

                <!-- Edit Mode Actions -->
                <div class="social-links-actions" id="socialLinksActions">
                  <button
                    class="social-links-action-btn social-links-save-btn"
                    onclick="saveSocialLinks()"
                  >
                    <span>üíæ</span>
                    <span>Save Changes</span>
                  </button>
                  <button
                    class="social-links-action-btn social-links-cancel-btn"
                    onclick="cancelSocialLinksEdit()"
                  >
                    <span>‚ùå</span>
                    <span>Close</span>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Achievements Section -->
          <div class="achievements-section">
            <h2 class="section-title">üèÜ Achievements</h2>
            <div class="achievements-grid" id="achievementsGrid">
              <div class="loading">Loading achievements...</div>
            </div>
          </div>

          <!-- Question History -->
          <div class="content-section">
            <h2 class="section-title">üìö Question History</h2>

            <!-- Add this search bar section -->
            <div
              class="search-container"
              style="margin-bottom: var(--codeleaf-space-4)"
            >
              <div class="search-input-wrapper">
                <input
                  type="text"
                  id="questionSearch"
                  class="search-input"
                  placeholder="Search by Day Number or Question Title..."
                  aria-label="Search question history"
                />
                <div class="search-icon">üîç</div>
                <div class="search-loader" id="questionSearchLoader">
                  <div class="loader-spinner"></div>
                </div>
                <button
                  class="search-clear"
                  id="questionSearchClear"
                  aria-label="Clear search"
                >
                  √ó
                </button>
              </div>
            </div>

            <div class="content-grid" id="questionHistory">
              <div class="loading">Loading question history...</div>
            </div>
          </div>

          <!-- Blogs Section -->
          <div class="content-section">
            <h2 class="section-title">‚úçÔ∏è My Blogs</h2>

            <!-- Add this search bar section -->
            <div
              class="search-container"
              style="margin-bottom: var(--codeleaf-space-4)"
            >
              <div class="search-input-wrapper">
                <input
                  type="text"
                  id="blogsSearch"
                  class="search-input"
                  placeholder="Search blogs by title or content keywords..."
                  aria-label="Search blogs"
                />
                <div class="search-icon">üîç</div>
                <div class="search-loader" id="blogsSearchLoader">
                  <div class="loader-spinner"></div>
                </div>
                <button
                  class="search-clear"
                  id="blogsSearchClear"
                  aria-label="Clear search"
                >
                  √ó
                </button>
              </div>
            </div>

            <!-- Search Results Info -->
            <div
              class="search-results-info"
              id="blogsSearchResultsInfo"
              style="display: none"
            >
              <div class="search-results-header">
                <span id="blogsSearchResultsCount">0 results</span>
                <button class="clear-search-btn" id="blogsClearSearchBtn">
                  Clear search
                </button>
              </div>
            </div>

            <div class="tabs" style="margin-bottom: var(--codeleaf-space-4)">
              <button class="tab active" onclick="switchBlogTab('public')">
                Public Blogs
              </button>
              <button class="tab" onclick="switchBlogTab('private')">
                Private Blogs
              </button>
            </div>
            <div class="content-grid" id="blogsContent">
              <div class="loading">Loading blogs...</div>
            </div>
          </div>
        </div>

        <!-- Right Column (30%) -->
        <div class="right-column">
          <!-- Premium Interactive Progress Chart -->
          <div class="progress-chart-section">
            <h2 class="section-title">üéØ Progress Overview</h2>
            <div class="progress-chart-container" id="progressChartContainer">
              <div
                class="progress-chart-wrapper"
                id="progressChartWrapper"
                tabindex="0"
                role="application"
                aria-label="Progress chart showing solved problems by difficulty level"
              >
                <svg
                  class="progress-chart-svg"
                  viewBox="0 0 100 100"
                  aria-hidden="true"
                >
                  <!-- Total background circle -->
                  <circle
                    class="progress-circle total"
                    cx="50"
                    cy="50"
                    r="44"
                    data-difficulty="total"
                    data-count="0"
                  />

                  <!-- Progress segments will be dynamically inserted here in order: Easy -> Medium -> Hard -->
                </svg>

                <!-- Center content -->
                <div class="progress-chart-center" id="progressChartCenter">
                  <div class="progress-total" id="progressTotal">0</div>
                  <div class="progress-label" id="progressLabel">
                    Total Solved
                  </div>
                  <div class="shimmer-effect" id="shimmerEffect"></div>
                </div>

                <!-- Tooltip -->
                <div class="progress-tooltip" id="progressTooltip"></div>
              </div>

              <!-- Enhanced Legend -->
              <div
                class="progress-legend"
                id="progressLegend"
                role="radiogroup"
                aria-label="Filter by difficulty level"
              >
                <!-- Legend items will be dynamically inserted here -->
              </div>
            </div>
          </div>

          <!-- Consistency Map -->
          <div class="consistency-map">
            <h2 class="section-title">üìà Consistency Map</h2>
            <div class="heatmap-container">
              <div class="heatmap-header">
                <div class="heatmap-title">Activity Heatmap</div>
                <div class="heatmap-legend">
                  <span>Less</span>
                  <div class="legend-colors">
                    <div class="legend-color level-0"></div>
                    <div class="legend-color level-1"></div>
                    <div class="legend-color level-2"></div>
                    <div class="legend-color level-3"></div>
                    <div class="legend-color level-4"></div>
                  </div>
                  <span>More</span>
                </div>
              </div>
              <div class="heatmap-content">
                <div class="months-row" id="heatmapMonths">
                  <!-- Month labels will be generated by JavaScript -->
                </div>
                <div class="heatmap-grid" id="heatmapGrid">
                  <!-- Heatmap cells will be generated by JavaScript -->
                </div>
              </div>
            </div>
          </div>

          <!-- Progress Visualization -->
          <div class="progress-section">
            <h2 class="section-title">üìä Progress Overview</h2>
            <div class="progress-bars" id="progressBars">
              <div class="loading">Loading progress data...</div>
            </div>
          </div>

          <!-- User Directory -->
          <div class="user-directory">
            <h2 class="section-title">üë• Community</h2>

            <!-- Search Bar -->
            <div class="search-container">
              <div class="search-input-wrapper">
                <input
                  type="text"
                  id="userSearch"
                  class="search-input"
                  placeholder="Search community members by username..."
                  aria-label="Search community members"
                />
                <div class="search-icon">üîç</div>
                <div class="search-loader" id="searchLoader">
                  <div class="loader-spinner"></div>
                </div>
                <button
                  class="search-clear"
                  id="searchClear"
                  aria-label="Clear search"
                >
                  √ó
                </button>
              </div>
            </div>

            <div class="user-grid" id="userDirectory">
              <div class="loading">Loading community data...</div>
            </div>

            <!-- Search Results State -->
            <div
              class="search-results-info"
              id="searchResultsInfo"
              style="display: none; margin-top: 10px"
            >
              <div class="search-results-header">
                <span id="searchResultsCount">0 results</span>
                <button class="clear-search-btn" id="clearSearchBtn">
                  Clear search
                </button>
              </div>
            </div>
          </div>

          <!-- Level Up Guide Section -->
          <div class="level-up-guide">
            <h2 class="section-title">üöÄ How to Level Up</h2>
            <div class="guide-content">
              <!-- Quick Tips -->
              <div class="guide-tips">
                <h3>üí° Quick Tips</h3>
                <div class="tip-item">
                  <span class="tip-icon">üìö</span>
                  <span class="tip-text"
                    >Solve problems daily to build consistency</span
                  >
                </div>
                <div class="tip-item">
                  <span class="tip-icon">‚úçÔ∏è</span>
                  <span class="tip-text"
                    >Write blogs to share knowledge (+25 XP each)</span
                  >
                </div>
                <div class="tip-item">
                  <span class="tip-icon">üî•</span>
                  <span class="tip-text">Maintain streaks for bonus XP</span>
                </div>
                <div class="tip-item">
                  <span class="tip-icon">üí¨</span>
                  <span class="tip-text">Engage with community blogs</span>
                </div>
              </div>

              <!-- XP Breakdown -->
              <div class="xp-breakdown">
                <h3>üèÜ XP Breakdown</h3>
                <div class="xp-item">
                  <span class="xp-source">Problems Solved</span>
                  <span class="xp-value">+10 XP each</span>
                </div>
                <div class="xp-item">
                  <span class="xp-source">Blogs Published</span>
                  <span class="xp-value">+25 XP each</span>
                </div>
                <div class="xp-item">
                  <span class="xp-source">Daily Streak</span>
                  <span class="xp-value">+5 XP per day</span>
                </div>
                <div class="xp-item">
                  <span class="xp-source">Blog Likes Received</span>
                  <span class="xp-value">+3 XP each</span>
                </div>
              </div>

              <!-- Level Meanings -->
              <div class="level-meanings">
                <h3>üìä Level Guide</h3>
                <div class="level-item">
                  <span class="level-badge-small seedling">üå±</span>
                  <div class="level-info">
                    <strong>Seedling</strong>
                    <small>Just starting your coding journey</small>
                  </div>
                </div>
                <div class="level-item">
                  <span class="level-badge-small sprout">üåø</span>
                  <div class="level-info">
                    <strong>Sprout</strong>
                    <small>Growing your skills steadily</small>
                  </div>
                </div>
                <div class="level-item">
                  <span class="level-badge-small builder">üî®</span>
                  <div class="level-info">
                    <strong>Builder</strong>
                    <small>Building solid foundations</small>
                  </div>
                </div>
                <div class="level-item">
                  <span class="level-badge-small explorer">üß≠</span>
                  <div class="level-info">
                    <strong>Explorer</strong>
                    <small>Exploring advanced concepts</small>
                  </div>
                </div>
                <div class="level-item">
                  <span class="level-badge-small sage">üìö</span>
                  <div class="level-info">
                    <strong>Sage</strong>
                    <small>Gaining deep knowledge</small>
                  </div>
                </div>
                <div class="level-item">
                  <span class="level-badge-small virtuoso">üéº</span>
                  <div class="level-info">
                    <strong>Virtuoso</strong>
                    <small>Mastering the craft</small>
                  </div>
                </div>
                <div class="level-item">
                  <span class="level-badge-small luminary">üåü</span>
                  <div class="level-info">
                    <strong>Luminary</strong>
                    <small>Shining example to the community</small>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="js/profile.js"></script>
  </body>
</html>